<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RouteController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">IndividualProject</a> &gt; <a href="index.source.html" class="el_package">dev.coms4156.project.individualproject</a> &gt; <span class="el_source">RouteController.java</span></div><h1>RouteController.java</h1><pre class="source lang-java linenums">package dev.coms4156.project.individualproject;

import java.util.HashMap;
import java.util.Locale;
import java.util.logging.Logger;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PatchMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

/**
 * This class contains all the API routes for the system.
 */

@RestController
<span class="fc" id="L20">public class RouteController {</span>
<span class="fc" id="L21">  Logger log = Logger.getLogger(RouteController.class.getName());</span>
  /**
   * Redirects to the homepage.
   *
   * @return A String containing the name of the html file to be loaded.
   */

  @GetMapping({&quot;/&quot;, &quot;/index&quot;, &quot;/home&quot;})
  public String index() {
<span class="nc" id="L30">    return &quot;Welcome, in order to make an API call direct your browser or Postman to an endpoint &quot;</span>
      + &quot;\n\n This can be done using the following format: \n\n http:127.0.0&quot;
      + &quot;.1:8080/endpoint?arg=value&quot;;
  }

  /**
   * Returns the details of the specified department.
   *
   * @param deptCode A {@code String} representing the department the user wishes
   *                 to retrieve.
   *
   * @return A {@code ResponseEntity} object containing either the details of the Department and
   *         an HTTP 200 response or, an appropriate message indicating the proper response.
   */
  @GetMapping(value = &quot;/retrieveDept&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; retrieveDepartment(@RequestParam(value = &quot;deptCode&quot;) String deptCode) {
    try {
      HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L48">      departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>

      // Use Locale.ROOT for locale-independent case transformation
<span class="fc" id="L51">      String deptCodeUpper = deptCode.toUpperCase(Locale.ROOT);</span>

<span class="fc bfc" id="L53" title="All 2 branches covered.">      if (!departmentMapping.containsKey(deptCodeUpper)) {</span>
<span class="fc" id="L54">        return new ResponseEntity&lt;&gt;(&quot;Department Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      } else {
<span class="fc" id="L56">        return new ResponseEntity&lt;&gt;(departmentMapping.get(deptCodeUpper).toString(),</span>
          HttpStatus.OK);
      }

<span class="nc" id="L60">    } catch (Exception e) {</span>
<span class="nc" id="L61">      return handleException(e);</span>
    }
  }


  /**
   * Displays the details of the requested course to the user or displays the proper error
   * message in response to the request.
   *
   * @param deptCode   A {@code String} representing the department the user wishes
   *                   to find the course in.
   *
   * @param courseCode A {@code int} representing the course the user wishes
   *                   to retrieve.
   *
   * @return           A {@code ResponseEntity} object containing either the details of the
   *                   course and an HTTP 200 response or, an appropriate message indicating the
   *                   proper response.
   */
  @GetMapping(value = &quot;/retrieveCourse&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; retrieveCourse(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                          @RequestParam(value = &quot;courseCode&quot;) int courseCode) {
    try {
<span class="fc bfc" id="L84" title="All 2 branches covered.">      boolean doesDepartmentExists = retrieveDepartment(deptCode).getStatusCode() == HttpStatus.OK;</span>
<span class="fc bfc" id="L85" title="All 2 branches covered.">      if (doesDepartmentExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L87">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
        HashMap&lt;String, Course&gt; coursesMapping;
<span class="fc" id="L89">        coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>

<span class="fc bfc" id="L91" title="All 2 branches covered.">        if (!coursesMapping.containsKey(Integer.toString(courseCode))) {</span>
<span class="fc" id="L92">          return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
        } else {
<span class="fc" id="L94">          return new ResponseEntity&lt;&gt;(coursesMapping.get(Integer.toString(courseCode)).toString(),</span>
            HttpStatus.OK);
        }

      }
<span class="fc" id="L99">      return new ResponseEntity&lt;&gt;(&quot;Department Not Found&quot;, HttpStatus.NOT_FOUND);</span>
<span class="nc" id="L100">    } catch (Exception e) {</span>
<span class="nc" id="L101">      return handleException(e);</span>
    }
  }

  /**
   * Displays whether the course has at minimum reached its enrollmentCapacity.
   *
   * @param deptCode   A {@code String} representing the department the user wishes
   *                   to find the course in.
   *
   * @param courseCode A {@code int} representing the course the user wishes
   *                   to retrieve.
   *
   * @return           A {@code ResponseEntity} object containing either the requested information
   *                   and an HTTP 200 response or, an appropriate message indicating the proper
   *                   response.
   */
  @GetMapping(value = &quot;/isCourseFull&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; isCourseFull(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                        @RequestParam(value = &quot;courseCode&quot;) int courseCode) {
    try {
      boolean doesCourseExists;
<span class="fc bfc" id="L123" title="All 2 branches covered.">      doesCourseExists = retrieveCourse(deptCode, courseCode).getStatusCode() == HttpStatus.OK;</span>

<span class="fc bfc" id="L125" title="All 2 branches covered.">      if (doesCourseExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L127">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
        HashMap&lt;String, Course&gt; coursesMapping;
<span class="fc" id="L129">        coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>

<span class="fc" id="L131">        Course requestedCourse = coursesMapping.get(Integer.toString(courseCode));</span>

        // Check if the course is full
<span class="fc" id="L134">        boolean isFull = requestedCourse.isCourseFull();</span>

<span class="fc bfc" id="L136" title="All 2 branches covered.">        if (isFull) {</span>
<span class="fc" id="L137">          return new ResponseEntity&lt;&gt;(&quot;Course is full&quot;, HttpStatus.CONFLICT);</span>
        } else {
<span class="fc" id="L139">          return new ResponseEntity&lt;&gt;(&quot;Course is not full&quot;, HttpStatus.OK);</span>
        }
      } else {
<span class="fc" id="L142">        return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      }

<span class="nc" id="L145">    } catch (Exception e) {</span>
<span class="nc" id="L146">      return handleException(e);</span>
    }
  }


  /**
   * Displays the number of majors in the specified department.
   *
   * @param deptCode     A {@code String} representing the department the user wishes
   *                     to find number of majors for.
   *
   * @return             A {@code ResponseEntity} object containing either number of majors for the
   *                     specified department and an HTTP 200 response or, an appropriate message
   *                     indicating the proper response.
   */
  @GetMapping(value = &quot;/getMajorCountFromDept&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; getMajorCtFromDept(@RequestParam(value = &quot;deptCode&quot;) String deptCode) {
    try {
<span class="fc bfc" id="L164" title="All 2 branches covered.">      boolean doesDepartmentExists = retrieveDepartment(deptCode).getStatusCode() == HttpStatus.OK;</span>
<span class="fc bfc" id="L165" title="All 2 branches covered.">      if (doesDepartmentExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L167">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
<span class="fc" id="L168">        return new ResponseEntity&lt;&gt;(&quot;There are: &quot; + departmentMapping.get(deptCode)</span>
<span class="fc" id="L169">          .getNumberOfMajors() + &quot; majors in the department&quot;, HttpStatus.OK);</span>
      }
<span class="fc" id="L171">      return new ResponseEntity&lt;&gt;(&quot;Department Not Found&quot;, HttpStatus.NOT_FOUND);</span>
<span class="nc" id="L172">    } catch (Exception e) {</span>
<span class="nc" id="L173">      return handleException(e);</span>
    }
  }

  /**
   * Displays the department chair for the specified department.
   *
   * @param deptCode  A {@code String} representing the department the user wishes
   *                  to find the department chair of.
   *
   * @return          A {@code ResponseEntity} object containing either department chair of the
   *                  specified department and an HTTP 200 response or, an appropriate message
   *                  indicating the proper response.
   */
  @GetMapping(value = &quot;/idDeptChair&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; identifyDeptChair(@RequestParam(value = &quot;deptCode&quot;) String deptCode) {
    try {
<span class="fc bfc" id="L190" title="All 2 branches covered.">      boolean doesDepartmentExists = retrieveDepartment(deptCode).getStatusCode() == HttpStatus.OK;</span>
<span class="fc bfc" id="L191" title="All 2 branches covered.">      if (doesDepartmentExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L193">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
<span class="fc" id="L194">        return new ResponseEntity&lt;&gt;(departmentMapping.get(deptCode).getDepartmentChair() + &quot; is &quot;</span>
          + &quot;the department chair.&quot;, HttpStatus.OK);
      }
<span class="fc" id="L197">      return new ResponseEntity&lt;&gt;(&quot;Department Not Found&quot;, HttpStatus.NOT_FOUND);</span>
<span class="nc" id="L198">    } catch (Exception e) {</span>
<span class="nc" id="L199">      return handleException(e);</span>
    }
  }

  /**
   * Displays the location for the specified course.
   *
   * @param deptCode   A {@code String} representing the department the user wishes
   *                   to find the course in.
   *
   * @param courseCode A {@code int} representing the course the user wishes
   *                   to find information about.
   *
   * @return           A {@code ResponseEntity} object containing either the location of the
   *                   course and an HTTP 200 response or, an appropriate message indicating the
   *                   proper response.
   */
  @GetMapping(value = &quot;/findCourseLocation&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; findCourseLocation(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                              @RequestParam(value = &quot;courseCode&quot;) int courseCode) {
    try {
      boolean doesCourseExists;
<span class="fc bfc" id="L221" title="All 2 branches covered.">      doesCourseExists = retrieveCourse(deptCode, courseCode).getStatusCode() == HttpStatus.OK;</span>

<span class="fc bfc" id="L223" title="All 2 branches covered.">      if (doesCourseExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L225">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
        HashMap&lt;String, Course&gt; coursesMapping;
<span class="fc" id="L227">        coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>

<span class="fc" id="L229">        Course requestedCourse = coursesMapping.get(Integer.toString(courseCode));</span>
<span class="fc" id="L230">        return new ResponseEntity&lt;&gt;(requestedCourse.getCourseLocation() + &quot; is where the course &quot;</span>
          + &quot;is located.&quot;, HttpStatus.OK);
      } else {
<span class="fc" id="L233">        return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      }

<span class="nc" id="L236">    } catch (Exception e) {</span>
<span class="nc" id="L237">      return handleException(e);</span>
    }
  }

  /**
   * Displays the instructor for the specified course.
   *
   * @param deptCode   A {@code String} representing the department the user wishes
   *                   to find the course in.
   *
   * @param courseCode A {@code int} representing the course the user wishes
   *                   to find information about.
   *
   * @return           A {@code ResponseEntity} object containing either the course instructor and
   *                   an HTTP 200 response or, an appropriate message indicating the proper
   *                   response.
   */
  @GetMapping(value = &quot;/findCourseInstructor&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; findCourseInstructor(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                                @RequestParam(value = &quot;courseCode&quot;)
                                                int courseCode) {
    try {
      boolean doesCourseExists;
<span class="fc bfc" id="L260" title="All 2 branches covered.">      doesCourseExists = retrieveCourse(deptCode, courseCode).getStatusCode() == HttpStatus.OK;</span>

<span class="fc bfc" id="L262" title="All 2 branches covered.">      if (doesCourseExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L264">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
        HashMap&lt;String, Course&gt; coursesMapping;
<span class="fc" id="L266">        coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>

<span class="fc" id="L268">        Course requestedCourse = coursesMapping.get(Integer.toString(courseCode));</span>
<span class="fc" id="L269">        return new ResponseEntity&lt;&gt;(requestedCourse.getInstructorName() + &quot; is the instructor for&quot;</span>
          + &quot; the course.&quot;, HttpStatus.OK);
      } else {
<span class="fc" id="L272">        return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      }

<span class="nc" id="L275">    } catch (Exception e) {</span>
<span class="nc" id="L276">      return handleException(e);</span>
    }
  }

  /**
   * Displays the time the course meets at for the specified course.
   *
   * @param deptCode   A {@code String} representing the department the user wishes
   *                   to find the course in.
   *
   * @param courseCode A {@code int} representing the course the user wishes
   *                   to find information about.
   *
   * @return           A {@code ResponseEntity} object containing either the details of the
   *                   course timeslot and an HTTP 200 response or, an appropriate message
   *                   indicating the proper response.
   */
  @GetMapping(value = &quot;/findCourseTime&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; findCourseTime(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                          @RequestParam(value = &quot;courseCode&quot;) int courseCode) {
    try {
      boolean doesCourseExists;
<span class="nc bnc" id="L298" title="All 2 branches missed.">      doesCourseExists = retrieveCourse(deptCode, courseCode).getStatusCode() == HttpStatus.OK;</span>

<span class="nc bnc" id="L300" title="All 2 branches missed.">      if (doesCourseExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="nc" id="L302">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
        HashMap&lt;String, Course&gt; coursesMapping;
<span class="nc" id="L304">        coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>

<span class="nc" id="L306">        Course requestedCourse = coursesMapping.get(Integer.toString(courseCode));</span>
<span class="nc" id="L307">        return new ResponseEntity&lt;&gt;(&quot;The course meets at: &quot; + &quot;some time &quot;,</span>
          HttpStatus.OK);
      } else {
<span class="nc" id="L310">        return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      }
<span class="nc" id="L312">    } catch (Exception e) {</span>
<span class="nc" id="L313">      return handleException(e);</span>
    }
  }

  /**
   * Attempts to add a student to the specified department.
   *
   * @param deptCode       A {@code String} representing the department.
   *
   * @return               A {@code ResponseEntity} object containing an HTTP 200
   *                       response with an appropriate message or the proper status
   *                       code in tune with what has happened.
   */
  @PatchMapping(value = &quot;/addMajorToDept&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; addMajorToDept(@RequestParam(value = &quot;deptCode&quot;) String deptCode) {
    try {
<span class="pc bpc" id="L329" title="1 of 2 branches missed.">      boolean doesDepartmentExists = retrieveDepartment(deptCode).getStatusCode() == HttpStatus.OK;</span>
<span class="pc bpc" id="L330" title="1 of 2 branches missed.">      if (doesDepartmentExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L332">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>

<span class="fc" id="L334">        Department specifiedDept = departmentMapping.get(deptCode);</span>
<span class="fc" id="L335">        specifiedDept.addMajorToDepartment();</span>
<span class="fc" id="L336">        return new ResponseEntity&lt;&gt;(&quot;Attribute was updated successfully&quot;, HttpStatus.OK);</span>
      }
<span class="nc" id="L338">      return new ResponseEntity&lt;&gt;(&quot;Department Not Found&quot;, HttpStatus.NOT_FOUND);</span>
<span class="nc" id="L339">    } catch (Exception e) {</span>
<span class="nc" id="L340">      return handleException(e);</span>
    }
  }

  /**
   * Attempts to remove a student from the specified department.
   *
   * @param deptCode       A {@code String} representing the department.
   *
   * @return               A {@code ResponseEntity} object containing an HTTP 200
   *                       response with an appropriate message or the proper status
   *                       code in tune with what has happened.
   */
  @PatchMapping(value = &quot;/removeMajorFromDept&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; removeMajorFromDept(@RequestParam(value = &quot;deptCode&quot;) String deptCode) {
    try {
<span class="fc bfc" id="L356" title="All 2 branches covered.">      boolean doesDepartmentExists = retrieveDepartment(deptCode).getStatusCode() == HttpStatus.OK;</span>
<span class="fc bfc" id="L357" title="All 2 branches covered.">      if (doesDepartmentExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L359">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>

<span class="fc" id="L361">        Department specifiedDept = departmentMapping.get(deptCode);</span>
<span class="fc bfc" id="L362" title="All 2 branches covered.">        if (specifiedDept.getNumberOfMajors() &lt;= 0) {</span>
<span class="fc" id="L363">          return new ResponseEntity&lt;&gt;(&quot;Attribute was updated or is at minimum&quot;,</span>
            HttpStatus.BAD_REQUEST);
        }
<span class="fc" id="L366">        specifiedDept.dropPersonFromMajor();</span>
<span class="fc" id="L367">        return new ResponseEntity&lt;&gt;(&quot;Major count was updated successfully&quot;, HttpStatus.OK);</span>
      }
<span class="fc" id="L369">      return new ResponseEntity&lt;&gt;(&quot;Department Not Found&quot;, HttpStatus.NOT_FOUND);</span>
<span class="nc" id="L370">    } catch (Exception e) {</span>
<span class="nc" id="L371">      return handleException(e);</span>
    }
  }

  /**
   * Attempts to drop a student from the specified course.
   *
   * @param deptCode       A {@code String} representing the department.
   *
   * @param courseCode     A {@code int} representing the course within the department.
   *
   * @return               A {@code ResponseEntity} object containing an HTTP 200
   *                       response with an appropriate message or the proper status
   *                       code in tune with what has happened.
   */
  @PatchMapping(value = &quot;/dropStudentFromCourse&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; dropStudent(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                       @RequestParam(value = &quot;courseCode&quot;) int courseCode) {
    try {
      boolean doesCourseExists;
<span class="fc bfc" id="L391" title="All 2 branches covered.">      doesCourseExists = retrieveCourse(deptCode, courseCode).getStatusCode() == HttpStatus.OK;</span>

<span class="fc bfc" id="L393" title="All 2 branches covered.">      if (doesCourseExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L395">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
        HashMap&lt;String, Course&gt; coursesMapping;
<span class="fc" id="L397">        coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>

<span class="fc" id="L399">        Course requestedCourse = coursesMapping.get(Integer.toString(courseCode));</span>
<span class="fc" id="L400">        boolean isStudentDropped = requestedCourse.dropStudent();</span>

<span class="pc bpc" id="L402" title="1 of 2 branches missed.">        if (isStudentDropped) {</span>
<span class="fc" id="L403">          return new ResponseEntity&lt;&gt;(&quot;Student has been dropped.&quot;, HttpStatus.OK);</span>
        } else {
<span class="nc" id="L405">          return new ResponseEntity&lt;&gt;(&quot;Student has not been dropped.&quot;, HttpStatus.BAD_REQUEST);</span>
        }
      } else {
<span class="fc" id="L408">        return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      }
<span class="nc" id="L410">    } catch (Exception e) {</span>
<span class="nc" id="L411">      return handleException(e);</span>
    }
  }
  /**
   * Updates the enrolled student count for a specific course in a department.
   * This method handles PATCH requests to set the enrollment count for a course identified by
   * department code and course code. If the course exists, the enrollment count is updated
   * to the provided value.
   *
   * @param deptCode   A {@code String} representing the department code.
   * @param courseCode An {@code int} representing the course code within the department.
   * @param count      An {@code int} representing the new enrollment count for the course.
   * @return           A {@code ResponseEntity} object containing a success message and HTTP 200
   *                   status if the operation is successful, or an error message and HTTP 404
   *                   status if the course or department is not found.
   */

  @PatchMapping(value = &quot;/setEnrollmentCount&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; setEnrollmentCount(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                              @RequestParam(value = &quot;courseCode&quot;) int courseCode,
                                              @RequestParam(value = &quot;count&quot;) int count) {
    try {
      boolean doesCourseExists;
<span class="fc bfc" id="L434" title="All 2 branches covered.">      doesCourseExists = retrieveCourse(deptCode, courseCode).getStatusCode() == HttpStatus.OK;</span>

<span class="fc bfc" id="L436" title="All 2 branches covered.">      if (doesCourseExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L438">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
        HashMap&lt;String, Course&gt; coursesMapping;
<span class="fc" id="L440">        coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>

<span class="fc" id="L442">        Course requestedCourse = coursesMapping.get(Integer.toString(courseCode));</span>
<span class="fc" id="L443">        requestedCourse.setEnrolledStudentCount(count);</span>
<span class="fc" id="L444">        return new ResponseEntity&lt;&gt;(&quot;Attributed was updated successfully.&quot;, HttpStatus.OK);</span>
      } else {
<span class="fc" id="L446">        return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      }
<span class="nc" id="L448">    } catch (Exception e) {</span>
<span class="nc" id="L449">      return handleException(e);</span>
    }
  }

  /**
   * Endpoint for changing the time of a course.
   * This method handles PATCH requests to change the time of a course identified by
   * department code and course code.If the course exists, its time is updated to the provided time.
   *
   * @param deptCode                    the code of the department containing the course
   * @param courseCode                  the code of the course to change the time for
   * @param time                        the new time for the course
   *
   * @return                            a ResponseEntity with a success message if the operation is
   *                                    successful, or an error message if the course is not found
   */
  @PatchMapping(value = &quot;/changeCourseTime&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; changeCourseTime(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                            @RequestParam(value = &quot;courseCode&quot;) int courseCode,
                                            @RequestParam(value = &quot;time&quot;) String time) {
    try {
      boolean doesCourseExists;
<span class="pc bpc" id="L471" title="1 of 2 branches missed.">      doesCourseExists = retrieveCourse(deptCode, courseCode).getStatusCode() == HttpStatus.OK;</span>

<span class="pc bpc" id="L473" title="1 of 2 branches missed.">      if (doesCourseExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L475">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
        HashMap&lt;String, Course&gt; coursesMapping;
<span class="fc" id="L477">        coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>

<span class="fc" id="L479">        Course requestedCourse = coursesMapping.get(Integer.toString(courseCode));</span>
<span class="fc" id="L480">        requestedCourse.reassignTime(time);</span>
<span class="fc" id="L481">        return new ResponseEntity&lt;&gt;(&quot;Attributed was updated successfully.&quot;, HttpStatus.OK);</span>
      } else {
<span class="nc" id="L483">        return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      }
<span class="nc" id="L485">    } catch (Exception e) {</span>
<span class="nc" id="L486">      return handleException(e);</span>
    }
  }

  /**
   * Endpoint for changing the instructor of a course.
   * This method handles PATCH requests to change the instructor of a course identified by
   * department code and course code. If the course exists, its instructor is updated to the
   * provided instructor.
   *
   * @param deptCode                  the code of the department containing the course
   * @param courseCode                the code of the course to change the instructor for
   * @param teacher                   the new instructor for the course
   *
   * @return                          a ResponseEntity with a success message if the operation is
   *                                  successful, or an error message if the course is not found
   */
  @PatchMapping(value = &quot;/changeCourseTeacher&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; changeCourseTeacher(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                               @RequestParam(value = &quot;courseCode&quot;) int courseCode,
                                               @RequestParam(value = &quot;teacher&quot;) String teacher) {
    try {
      boolean doesCourseExists;
<span class="fc bfc" id="L509" title="All 2 branches covered.">      doesCourseExists = retrieveCourse(deptCode, courseCode).getStatusCode() == HttpStatus.OK;</span>

<span class="fc bfc" id="L511" title="All 2 branches covered.">      if (doesCourseExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L513">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
        HashMap&lt;String, Course&gt; coursesMapping;
<span class="fc" id="L515">        coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>

<span class="fc" id="L517">        Course requestedCourse = coursesMapping.get(Integer.toString(courseCode));</span>
<span class="fc" id="L518">        requestedCourse.reassignInstructor(teacher);</span>
<span class="fc" id="L519">        return new ResponseEntity&lt;&gt;(&quot;Attributed was updated successfully.&quot;, HttpStatus.OK);</span>
      } else {
<span class="fc" id="L521">        return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      }
<span class="nc" id="L523">    } catch (Exception e) {</span>
<span class="nc" id="L524">      return handleException(e);</span>
    }
  }

  /**
   * Changes the location of a specific course in a department.
   * This method handles PATCH requests to change the location of a course identified by
   * department code and course code. If the course exists, its location is updated
   * to the provided value.
   *
   * @param deptCode   A {@code String} representing the department code.
   * @param courseCode An {@code int} representing the course code within the department.
   * @param location   A {@code String} representing the new location for the course.
   * @return           A {@code ResponseEntity} object containing a success message and HTTP 200
   *                   status if the operation is successful, or an error message and HTTP 404
   *                   status if the course or department is not found.
   */
  @PatchMapping(value = &quot;/changeCourseLocation&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; changeCourseLocation(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                                @RequestParam(value = &quot;courseCode&quot;) int courseCode,
                                                @RequestParam(value = &quot;location&quot;) String location) {
    try {
      boolean doesCourseExists;
<span class="fc bfc" id="L547" title="All 2 branches covered.">      doesCourseExists = retrieveCourse(deptCode, courseCode).getStatusCode() == HttpStatus.OK;</span>

<span class="fc bfc" id="L549" title="All 2 branches covered.">      if (doesCourseExists) {</span>
        HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L551">        departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
        HashMap&lt;String, Course&gt; coursesMapping;
<span class="fc" id="L553">        coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>

<span class="fc" id="L555">        Course requestedCourse = coursesMapping.get(Integer.toString(courseCode));</span>
<span class="fc" id="L556">        requestedCourse.reassignLocation(location);</span>
<span class="fc" id="L557">        return new ResponseEntity&lt;&gt;(&quot;Attributed was updated successfully.&quot;, HttpStatus.OK);</span>
      } else {
<span class="fc" id="L559">        return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      }
<span class="nc" id="L561">    } catch (Exception e) {</span>
<span class="nc" id="L562">      return handleException(e);</span>
    }
  }

  /**
   * Retrieves all courses with the specified course code across all departments.
   *
   * @param courseCode A {@code int} representing the course code to search for.
   * @return           A {@code ResponseEntity} containing a list of courses
   *                   with the specified course code, or an appropriate error message.
   */
  @GetMapping(value = &quot;/retrieveCourses&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; retrieveCourses(@RequestParam(value = &quot;courseCode&quot;) int courseCode) {
    try {
      HashMap&lt;String, Department&gt; departmentMapping;
<span class="fc" id="L577">      departmentMapping = IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
<span class="fc" id="L578">      StringBuilder result = new StringBuilder();</span>

<span class="fc bfc" id="L580" title="All 2 branches covered.">      for (Department department : departmentMapping.values()) {</span>
<span class="fc" id="L581">        HashMap&lt;String, Course&gt; coursesMapping = department.getCourseSelection();</span>
<span class="fc" id="L582">        Course course = coursesMapping.get(Integer.toString(courseCode));</span>
<span class="fc bfc" id="L583" title="All 2 branches covered.">        if (course != null) {</span>
<span class="fc" id="L584">          result.append(course.toString()).append('\n');</span>
        }
<span class="fc" id="L586">      }</span>

<span class="fc bfc" id="L588" title="All 2 branches covered.">      if (result.length() == 0) {</span>
<span class="fc" id="L589">        return new ResponseEntity&lt;&gt;(&quot;No courses found with the specified course code.&quot;,</span>
          HttpStatus.NOT_FOUND);
      } else {
<span class="fc" id="L592">        return new ResponseEntity&lt;&gt;(result.toString(), HttpStatus.OK);</span>
      }
<span class="nc" id="L594">    } catch (Exception e) {</span>
<span class="nc" id="L595">      return handleException(e);</span>
    }
  }

  /**
   * Attempts to enroll a student in a specified course.
   *
   * @param deptCode   A {@code String} representing the department code.
   * @param courseCode An {@code int} representing the course code within the department.
   * @return           A {@code ResponseEntity} object containing an appropriate message and status
   *                   based on the outcome of the enrollment attempt.
   */
  @PostMapping(value = &quot;/enrollStudentInCourse&quot;, produces = MediaType.APPLICATION_JSON_VALUE)
  public ResponseEntity&lt;?&gt; enrollStudentInCourse(@RequestParam(value = &quot;deptCode&quot;) String deptCode,
                                                 @RequestParam
                                                   (value = &quot;courseCode&quot;) int courseCode) {
    try {
      // Check if the course exists using the existing method
<span class="fc" id="L613">      ResponseEntity&lt;?&gt; courseResponse = retrieveCourse(deptCode, courseCode);</span>
<span class="fc bfc" id="L614" title="All 2 branches covered.">      if (courseResponse.getStatusCode() != HttpStatus.OK) {</span>
<span class="fc" id="L615">        return new ResponseEntity&lt;&gt;(&quot;Course Not Found&quot;, HttpStatus.NOT_FOUND);</span>
      }

      // Get the department and course details
<span class="fc" id="L619">      HashMap&lt;String, Department&gt; departmentMapping =</span>
<span class="fc" id="L620">          IndividualProjectApplication.myFileDatabase.getDepartmentMapping();</span>
<span class="fc" id="L621">      HashMap&lt;String, Course&gt; coursesMapping = departmentMapping.get(deptCode).getCourseSelection();</span>
<span class="fc" id="L622">      Course course = coursesMapping.get(Integer.toString(courseCode));</span>

      // Check if the course is already full
<span class="fc bfc" id="L625" title="All 2 branches covered.">      if (course.isCourseFull()) {</span>
<span class="fc" id="L626">        return new ResponseEntity&lt;&gt;(&quot;Cannot enroll student. Course is full.&quot;, HttpStatus.CONFLICT);</span>
      }

      // Attempt to enroll the student
<span class="fc" id="L630">      boolean enrollmentSuccess = course.enrollStudent();</span>

<span class="pc bpc" id="L632" title="1 of 2 branches missed.">      if (enrollmentSuccess) {</span>
<span class="fc" id="L633">        return new ResponseEntity&lt;&gt;(&quot;Student has been successfully enrolled in the course.&quot;,</span>
          HttpStatus.OK);
      } else {
<span class="nc" id="L636">        return new ResponseEntity&lt;&gt;(&quot;Failed to enroll student in the course.&quot;,</span>
          HttpStatus.BAD_REQUEST);
      }
<span class="nc" id="L639">    } catch (Exception e) {</span>
<span class="nc" id="L640">      return handleException(e);</span>
    }
  }


  private ResponseEntity&lt;?&gt; handleException(Exception e) {
<span class="nc" id="L646">    e.printStackTrace();</span>
<span class="nc" id="L647">    return new ResponseEntity&lt;&gt;(&quot;An Error has occurred&quot;, HttpStatus.OK);</span>
  }


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>